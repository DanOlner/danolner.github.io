[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Dan Olner’s Data Dispatch",
    "section": "",
    "text": "How to automate your way out of Excel hell & other ONS data wrangling stories (business demography edition)\n\n\n\n\n\n\ncode\n\n\nons\n\n\nfirms\n\n\n\n\n\n\n\n\n\nNov 5, 2024\n\n\nDan Olner\n\n\n\n\n\n\n\n\n\n\n\n\nWhat this situation needs is another blog, said no-one ever\n\n\n\n\n\n\ngumph\n\n\n\n\n\n\n\n\n\nNov 4, 2024\n\n\nDan Olner\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "What this situation needs is another blog, said no-one ever",
    "section": "",
    "text": "“Another blog! Thank the Gods! Blogging is so now, isn’t it?”\nThat’s quite enough sarcasm from you. What this lovely website is for:\n\nUsing the ace Quarto blogging platform for writing up data / techie / code / mapping stuff in a much more straightforward way than using Jekyll (the previous github frontend, now archived here). RStudio just makes it for you! With some tweaks.\nA place to explain what I’ve done with R projects - not least explaining them to future me. Future me is very forgetful and needs to have things laid out clearly.\nGet down the techie bits behind work I’m doing to support regional economic data analysis, so I can keep that separate from things like the regional economic tools site (also Quarto).\n\n*Links to my github / linkedin / bluesky / wordpress site (or use links up above).\nHere is a picture of a kitten on a unicorn, via here. You’re welcome."
  },
  {
    "objectID": "posts/business_demography/index.html",
    "href": "posts/business_demography/index.html",
    "title": "How to automate your way out of Excel hell & other ONS data wrangling stories (business demography edition)",
    "section": "",
    "text": "I’ve been analysing the latest ONS business demography data (that ONS pull from the IDBR). It contains a tonne of great data on business births, deaths, numbers, ‘high growth’ firms, survival rates, down to local authority level (though sadly sector breakdowns only at national level).\n\nMy report from that is here (a work in progress as I’m writing)\nPrep code is here\nQuarto code for the report is here\n\n\nGetting data out of Excel documents can be a bit extremely horrible [noting, to be clear, that Excel docs like this are super useful for many people, but just nasty for those of us who want to get the data into something like R or Python, so…]. In this case, what we’ve got is this:\n\nFor each type of data (firm births, deaths, active count, high growth count etc) there are four sheets covering different time periods, with two spanning two years and two with a single year. Why? That’s unclear until you check the geographies - the local authorities (LAs) used don’t match across sheets. Why? Because the boundaries changed, so there’s a different sheet each year they’ve changed.\n\nSo if we want consistent data across all time periods, we’ve got a couple of things to do:\n\nGet the data out of each set of four sheets into one;\nHarmonise the geographies so datapoints are consistent.\n\nLuckily, the LA changes have all been to combine into larger units over time (usually unitary authorities) - so all earlier LAs fit neatly into later boundaries. Phew. This means values from earlier LAs can be summed to the larger/later ones - backcasting 2022 boundaries through all previous data.\nSome anonymous angel/angels made this Wikipedia page clearly laying out when and what local authorities combined into larger unitary ones in recent years. Using that, we can piece together the changes to get to this function that does the harmonising. It groups previous LAs - that only needs to backcast 2021/2022 names once, no faffing around with each separate sheet - and then summarises counts for those new groups, for previous years’ data.\nPrior to that, though, we need to pull the sheets into R. There are a lot of sheets - doing this manually would be baaad…\n\nThe readxl package to the rescue! Part of the tidyverse, it can be used to automate extracting data from random places in the Excel document. I had somehow managed to miss up to now that this package allows you to specify exactly which cells to pull out, and from which sheet. I do that in the function here, specifically for pulling out the correct cells from the ONS demography Excel. That’s used in the code here.\n\n(Image stolen from here)."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "“Another blog! Thank the Gods! Blogging is so now, isn’t it?”\nThat’s quite enough sarcasm from you. What this lovely website is for:\n\nUsing the ace Quarto blogging platform for writing up data / techie / code / mapping stuff in a much more straightforward way than using Jekyll (the previous github frontend, now archived here). RStudio just makes it for you! With some tweaks.\nA place to explain what I’ve done with R projects - not least explaining them to future me. Future me is very forgetful and needs to have things laid out clearly.\nGet down the techie bits behind work I’m doing to support regional economic data analysis, so I can keep that separate from things like the regional economic tools site (also Quarto).\n\n*Links to my github / linkedin / bluesky / wordpress site (or use links up above).\nHere is a picture of a kitten on a unicorn, via here. You’re welcome."
  }
]